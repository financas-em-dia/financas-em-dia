<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Finan√ßas em Dia</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#0f172a;--card:#020617;--primary:#22c55e;--danger:#ef4444;
--text:#e5e7eb;--muted:#94a3b8;--input:#020617;--border:#1e293b;
}
*{box-sizing:border-box;font-family:system-ui;}
body{margin:0;background:linear-gradient(180deg,#020617,#0f172a);color:var(--text);padding:12px;}
.container{max-width:480px;margin:auto;}
h1{text-align:center;margin:10px 0;font-size:1.4rem;}
.hidden{display:none;}

button{cursor:pointer}

.box{background:rgba(255,255,255,0.04);border:1px solid var(--border);border-radius:14px;padding:16px;margin-top:30px;}

input,select{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:var(--input);color:var(--text);}
label{font-size:.75rem;color:var(--muted);}
.field{margin-bottom:10px;}

button.main{width:100%;padding:12px;border:none;border-radius:12px;background:linear-gradient(135deg,#22c55e,#16a34a);color:#052e16;font-weight:700;margin-top:6px;}
button.sec{width:100%;padding:10px;border:1px solid var(--border);border-radius:12px;background:transparent;color:var(--text);margin-top:6px;}

.eye{position:absolute;right:12px;top:32px;cursor:pointer}
.passbox{position:relative}

/* APP */

.top-tabs{display:flex;gap:8px;margin-bottom:10px;}
.top-tabs button{flex:1;padding:10px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,0.05);color:var(--text);font-weight:600;}
.top-tabs button.active{background:linear-gradient(135deg,#22c55e,#16a34a);color:#052e16;}

.cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.card{background:rgba(255,255,255,0.03);border:1px solid var(--border);border-radius:14px;padding:12px;}
.card h3{font-size:.75rem;color:var(--muted);margin:0 0 6px;}
.card .value{font-size:1.1rem;font-weight:600;}
.card.saldo{grid-column:1/3;text-align:center;}

.form,.list,.chart-box{margin-top:15px;background:rgba(255,255,255,0.03);border:1px solid var(--border);border-radius:14px;padding:14px;}

.item{display:grid;grid-template-columns:1fr auto auto;gap:6px;align-items:center;padding:8px 0;border-bottom:1px solid var(--border);font-size:.78rem;}
.item:last-child{border-bottom:none;}
.cat{color:var(--muted);font-size:.7rem;}
.valor{text-align:right;min-width:80px;}
.valor.rec{color:var(--primary);} .valor.desp{color:var(--danger);}
.actions{display:flex;gap:4px;}
.actions button{font-size:.6rem;border:none;border-radius:6px;padding:4px 6px;}
.pay{background:#22c55e;color:#052e16;}
.back{background:#3b82f6;color:#fff;}
.edit{background:#f59e0b;color:#000;}
.del{background:#ef4444;color:#fff;}
</style>
</head>

<body>
<div class="container">

<!-- LOGIN -->
<div id="loginScreen">
<h1>üîê Finan√ßas em Dia</h1>
<div class="box">

<div class="field">
<label>Email</label>
<input id="emailLogin" type="email">
</div>

<div class="field passbox">
<label>Senha</label>
<input id="senhaLogin" type="password">
<span class="eye" onclick="toggle('senhaLogin')">üëÅ</span>
</div>

<button class="main" id="btnLogin">Entrar</button>
<button class="sec" onclick="showCadastro()">Primeiro acesso</button>
<button class="sec" id="btnReset">Esqueci minha senha</button>

<hr style="margin:14px 0;border-color:#1e293b">
<button class="main" id="btnGoogle">Entrar com Google</button>

</div>
</div>

<!-- CADASTRO -->
<div id="cadastroScreen" class="hidden">
<h1>üìù Criar Conta</h1>
<div class="box">

<div class="field">
<label>Email</label>
<input id="emailCad" type="email">
</div>

<div class="field passbox">
<label>Senha</label>
<input id="senhaCad" type="password">
<span class="eye" onclick="toggle('senhaCad')">üëÅ</span>
</div>

<div class="field passbox">
<label>Confirmar Senha</label>
<input id="senhaConf" type="password">
<span class="eye" onclick="toggle('senhaConf')">üëÅ</span>
</div>

<button class="main" id="btnCadastrar">Cadastrar</button>
<button class="sec" onclick="showLogin()">Voltar</button>

</div>
</div>

<!-- APP -->
<div id="appScreen" class="hidden">
<h1>üí∞ Finan√ßas em Dia</h1>

<div class="top-tabs">
<button id="tabMes" class="active" onclick="showMes()">M√™s</button>
<button id="tabAno" onclick="showAno()">Resumo Anual</button>
</div>

<div id="telaMes">

<select id="mesSelecionado"></select>

<div class="cards">
<div class="card"><h3>Receitas</h3><div class="value" id="rMes">R$0</div></div>
<div class="card"><h3>Despesas</h3><div class="value" id="dMes">R$0</div></div>
<div class="card saldo"><h3>Saldo</h3><div class="value" id="sMes">R$0</div></div>
</div>

<div class="form">
<h2>Novo Lan√ßamento</h2>

<select id="tipo">
<option value="">Tipo</option>
<option value="receita">Receita</option>
<option value="despesa">Despesa</option>
</select>

<div style="display:flex;gap:6px;">
<select id="categoria"></select>
<button onclick="novaCategoria()">+</button>
</div>

<input id="desc" placeholder="Descri√ß√£o">
<input id="valor" type="number" placeholder="Valor">
<input id="data" type="date">

<select id="repete">
<option value="">Tipo</option>
<option value="variavel">√önica</option>
<option value="fixa">Fixa</option>
<option value="parcelada">Parcelada</option>
</select>

<div id="parcelasBox" class="hidden">
<input id="parcelas" type="number" value="2">
</div>

<button class="main" onclick="adicionar()">Adicionar</button>
</div>

<div class="list" id="listaMes"></div>
<div class="chart-box"><canvas id="graficoMes"></canvas></div>

</div>

<div id="telaAno" class="hidden">
<div class="chart-box"><canvas id="graficoAno"></canvas></div>
</div>

<button class="sec" id="btnLogout">Sair</button>
</div>

</div>

<!-- FIREBASE + APP -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {
getAuth, GoogleAuthProvider, signInWithPopup,
signInWithEmailAndPassword, createUserWithEmailAndPassword,
sendPasswordResetEmail, onAuthStateChanged, signOut
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

import {
getFirestore, collection, addDoc, getDocs, deleteDoc, doc
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyBAWyMjRVAODIVkC5w95nu9MliqNUMb8ZY",
authDomain: "controle-financeiro-dffee.firebaseapp.com",
projectId: "controle-financeiro-dffee",
storageBucket: "controle-financeiro-dffee.firebasestorage.app",
messagingSenderId: "470526358884",
appId: "1:470526358884:web:0dcd3dffb5c0924dadf671"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

function traduzErro(e){
if(e.code==="auth/invalid-email") return "Email inv√°lido.";
if(e.code==="auth/wrong-password") return "Senha incorreta.";
if(e.code==="auth/user-not-found") return "Usu√°rio n√£o encontrado.";
if(e.code==="auth/email-already-in-use") return "Email j√° cadastrado.";
return "Erro ao autenticar.";
}

window.toggle=id=>{
const i=document.getElementById(id);
i.type=i.type==="password"?"text":"password";
}

window.showCadastro=()=>{loginScreen.classList.add("hidden");cadastroScreen.classList.remove("hidden");}
window.showLogin=()=>{cadastroScreen.classList.add("hidden");loginScreen.classList.remove("hidden");}

btnLogin.onclick=()=>signInWithEmailAndPassword(auth,emailLogin.value,senhaLogin.value).catch(e=>alert(traduzErro(e)));
btnCadastrar.onclick=()=>createUserWithEmailAndPassword(auth,emailCad.value,senhaCad.value).catch(e=>alert(traduzErro(e)));
btnReset.onclick=()=>sendPasswordResetEmail(auth,emailLogin.value).then(()=>alert("Email enviado."));
btnGoogle.onclick=()=>signInWithPopup(auth,provider);
btnLogout.onclick=()=>signOut(auth);

onAuthStateChanged(auth,user=>{
if(user){loginScreen.classList.add("hidden");cadastroScreen.classList.add("hidden");appScreen.classList.remove("hidden");}
else{appScreen.classList.add("hidden");showLogin();}
});
</script>
</body>
</html>





