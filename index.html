<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>FinanÃ§as em Dia</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#0f172a;--card:#020617;--primary:#22c55e;--danger:#ef4444;
--text:#e5e7eb;--muted:#94a3b8;--input:#020617;--border:#1e293b;
}
*{box-sizing:border-box;font-family:system-ui;}
body{margin:0;background:linear-gradient(180deg,#020617,#0f172a);color:var(--text);padding:12px;}
.container{max-width:520px;margin:auto;}
h1{text-align:center;margin:10px 0;font-size:1.4rem;}
.hidden{display:none}
button{cursor:pointer}

.box,.form,.list,.chart-box{
margin-top:15px;background:rgba(255,255,255,0.03);
border:1px solid var(--border);border-radius:14px;padding:14px;
}
.field{margin-bottom:10px;}
label{font-size:.75rem;color:var(--muted);display:block;margin-bottom:4px;}
input,select{
width:100%;padding:10px;border-radius:10px;
border:1px solid var(--border);background:var(--input);color:var(--text);
}
input[type="date"]::-webkit-calendar-picker-indicator{filter:invert(1);}

.top-tabs{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;}
.top-tabs button{
flex:1;padding:10px;border-radius:12px;border:1px solid var(--border);
background:rgba(255,255,255,0.05);color:var(--text);font-weight:600;
}
.top-tabs button.active{
background:linear-gradient(135deg,#22c55e,#16a34a);color:#052e16;
}

.cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.card{
background:rgba(255,255,255,0.03);border:1px solid var(--border);
border-radius:14px;padding:12px;
}
.card h3{font-size:.75rem;color:var(--muted);margin:0 0 6px;}
.card .value{font-size:1.1rem;font-weight:600;}
.card.saldo{grid-column:1/3;text-align:center;}

button.main{
width:100%;padding:12px;border:none;border-radius:12px;
background:linear-gradient(135deg,#22c55e,#16a34a);
color:#052e16;font-weight:700;
}
button.sec{
width:100%;padding:10px;border:1px solid var(--border);
border-radius:12px;background:transparent;color:var(--text);
margin-top:6px;
}

.item{
display:grid;grid-template-columns:1fr auto;gap:6px;
padding:8px 0;border-bottom:1px solid var(--border);
font-size:.78rem;
}
.item:last-child{border-bottom:none;}
.valor{text-align:right;}
.valor.pos{color:#22c55e}
.valor.neg{color:#ef4444}
</style>
</head>

<body>
<div class="container">

<h1>ðŸ’° FinanÃ§as em Dia</h1>

<div class="top-tabs">
<button onclick="show('mes')" class="active">MÃªs</button>
<button onclick="show('contas')">Contas</button>
<button onclick="show('transferencias')">TransferÃªncias</button>
</div>

<!-- TELA MES -->
<div id="mes">
<div class="cards">
<div class="card"><h3>Receitas</h3><div class="value" id="rMes">R$ 0</div></div>
<div class="card"><h3>Despesas</h3><div class="value" id="dMes">R$ 0</div></div>
<div class="card saldo"><h3>Saldo</h3><div class="value" id="sMes">R$ 0</div></div>
</div>
</div>

<!-- TELA CONTAS -->
<div id="contas" class="hidden">
<div class="form">
<h3>Nova Conta</h3>
<input id="contaNome" placeholder="Nome da conta">
<select id="contaTipo">
<option value="corrente">Corrente</option>
<option value="cartao">CartÃ£o</option>
<option value="poupanca">PoupanÃ§a</option>
</select>
<input id="contaSaldo" type="number" placeholder="Saldo inicial">
<button class="main" onclick="criarConta()">Criar Conta</button>
</div>
<div class="list" id="listaContas"></div>
</div>

<!-- TELA TRANSFERENCIAS -->
<div id="transferencias" class="hidden">
<div class="form">
<h3>Nova TransferÃªncia</h3>
<select id="origem"></select>
<select id="destino"></select>
<input id="valorTransf" type="number" placeholder="Valor">
<button class="main" onclick="criarTransferencia()">Transferir</button>
</div>
<div class="list" id="listaTransf"></div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyBAWyMjRVAODIVkC5w95nu9MliqNUMb8ZY",
authDomain: "controle-financeiro-dffee.firebaseapp.com",
projectId: "controle-financeiro-dffee",
storageBucket: "controle-financeiro-dffee.firebasestorage.app",
messagingSenderId: "470526358884",
appId: "1:470526358884:web:0dcd3dffb5c0924dadf671"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const uid = "demo";

const $ = id => document.getElementById(id);

let contas = [];
let transferencias = [];

window.show = tela => {
["mes","contas","transferencias"].forEach(t=>{
$(t).classList.toggle("hidden", t!==tela);
});
};

window.criarConta = async () => {
const nome = $("contaNome").value;
const tipo = $("contaTipo").value;
const saldo = Number($("contaSaldo").value||0);

if(!nome) return alert("Informe o nome");

await addDoc(collection(db,"users",uid,"contas"),{
nome,tipo,saldo
});

$("contaNome").value="";
$("contaSaldo").value="";

carregarContas();
};

async function carregarContas(){
contas=[];
const snap = await getDocs(collection(db,"users",uid,"contas"));
snap.forEach(d=>contas.push({id:d.id,...d.data()}));

$("listaContas").innerHTML="";
$("origem").innerHTML="";
$("destino").innerHTML="";

contas.forEach(c=>{
$("listaContas").innerHTML+=`
<div class="item"><div>${c.nome}</div><div class="valor pos">R$ ${c.saldo.toFixed(2)}</div></div>`;
$("origem").innerHTML+=`<option value="${c.id}">${c.nome}</option>`;
$("destino").innerHTML+=`<option value="${c.id}">${c.nome}</option>`;
});
}

window.criarTransferencia = async () => {
const origem = $("origem").value;
const destino = $("destino").value;
const valor = Number($("valorTransf").value);

if(origem===destino) return alert("Escolha contas diferentes");

await addDoc(collection(db,"users",uid,"transferencias"),{
origem,destino,valor
});

$("valorTransf").value="";
carregarTransferencias();
};

async function carregarTransferencias(){
transferencias=[];
const snap = await getDocs(collection(db,"users",uid,"transferencias"));
snap.forEach(d=>transferencias.push(d.data()));

$("listaTransf").innerHTML="";
transferencias.forEach(t=>{
$("listaTransf").innerHTML+=`
<div class="item"><div>${t.origem} â†’ ${t.destino}</div>
<div class="valor">R$ ${t.valor.toFixed(2)}</div></div>`;
});
}

carregarContas();
carregarTransferencias();
</script>

</body>
</html>

